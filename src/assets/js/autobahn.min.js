window.define||(window.define=function(e){try{delete window.define}catch(e){window.define=void 0}window.when=e()},window.define.amd={}),function(e){var n;e||(e=window.console={log:function(e,n,o,t,r){},info:function(e,n,o,t,r){},warn:function(e,n,o,t,r){},error:function(e,n,o,t,r){}}),Function.prototype.bind||(Function.prototype.bind=function(e){var n=this,o=Array.prototype.slice.call(arguments,1);return function(){return n.apply(e,Array.prototype.concat.apply(o,arguments))}}),"object"==typeof e.log&&(e.log=Function.prototype.call.bind(e.log,e),e.info=Function.prototype.call.bind(e.info,e),e.warn=Function.prototype.call.bind(e.warn,e),e.error=Function.prototype.call.bind(e.error,e)),"group"in e||(e.group=function(n){e.info("\n--- "+n+" ---\n")}),"groupEnd"in e||(e.groupEnd=function(){e.log("\n")}),"time"in e||(n={},e.time=function(e){n[e]=(new Date).getTime()},e.timeEnd=function(o){var t=(new Date).getTime();e.info(o+": "+(o in n?t-n[o]:0)+"ms")})}(window.console),("function"==typeof define&&define.amd?define:function(e){module.exports=e(require)})(function(e){function n(e,n,o,i){return(e instanceof t?e:r(e)).then(n,o,i)}function o(e){return new t(e,A.PromiseStatus&&A.PromiseStatus())}function t(e,n){function r(e){if(p){var r=p;p=N,d(function(){var u;f=function(e,n){if(n===e)return new c(new TypeError);if(n instanceof t)return n;try{var r=n===Object(n)&&n.then;return"function"==typeof r?(i=r,u=n,o(function(e,n){C(i,u,e,n)})):new s(n)}catch(e){return new c(e)}var i,u}(l,e),n&&(u=n,f.then(function(){u.fulfilled()},function(e){u.rejected(e)})),i(r,f)})}}function a(e){r(new c(e))}var l,f,p=[];l=this,this._status=n,this.inspect=function(){return f?f.inspect():{state:"pending"}},this._when=function(e,n,o,t,r){function i(i){i._when(e,n,o,t,r)}p?p.push(i):d(function(){i(f)})};try{e(r,a,function(e){if(p){var n=p;d(function(){i(n,new u(e))})}})}catch(e){a(e)}}function r(e){return o(function(n){n(e)})}function i(e,n){for(var o=0;o<e.length;o++)e[o](n)}function s(e){this.value=e}function c(e){this.value=e}function u(e){this.value=e}function a(e){return e&&"function"==typeof e.then}function l(e,t,r,i,s){return n(e,function(e){return o(function(o,r,i){function s(e){_(e)}function c(e){p(e)}var u,a,l,f,p,_,h,d;if(h=e.length>>>0,u=Math.max(0,Math.min(t,h)),l=[],a=h-u+1,f=[],u)for(_=function(e){f.push(e),--a||(p=_=b,r(f))},p=function(e){l.push(e),--u||(p=_=b,o(l))},d=0;d<h;++d)d in e&&n(e[d],c,s,i);else o(l)}).then(r,i,s)})}function f(e,n,o,t){return p(e,b).then(n,o,t)}function p(e,o,r){return n(e,function(e){return new t(function(t,i,s){function c(e,c){n(e,o,r).then(function(e){u[c]=e,--l||t(u)},i,s)}var u,a,l,f;if(l=a=e.length>>>0,u=[],l)for(f=0;f<a;f++)f in e?c(e[f],f):--l;else t(u)})})}function _(e){return{state:"fulfilled",value:e}}function h(e){return{state:"rejected",reason:e}}function d(e){1===x.push(e)&&O(g)}function g(){i(x),x=[]}function b(e){return e}function E(e){throw"function"==typeof A.reportUnhandled?A.reportUnhandled():d(function(){throw e}),e}var w,y,S,v,C,O,x,A,m,N,k,I,M,T;if(n.promise=o,n.resolve=r,n.reject=function(e){return n(e,function(e){return new c(e)})},n.defer=function(){var e,n,t;return(e={promise:N,resolve:N,reject:N,notify:N,resolver:{resolve:N,reject:N,notify:N}}).promise=n=o(function(o,i,s){e.resolve=e.resolver.resolve=function(e){return t?r(e):(t=!0,o(e),n)},e.reject=e.resolver.reject=function(e){return t?r(new c(e)):(t=!0,i(e),n)},e.notify=e.resolver.notify=function(e){return s(e),e}}),e},n.join=function(){return p(arguments,b)},n.all=f,n.map=function(e,n){return p(e,n)},n.reduce=function(e,o){var t=C(v,arguments,1);return n(e,function(e){var r;return r=e.length,t[0]=function(e,t,i){return n(e,function(e){return n(t,function(n){return o(e,n,i,r)})})},S.apply(e,t)})},n.settle=function(e){return p(e,_,h)},n.any=function(e,n,o,t){return l(e,1,function(e){return n?n(e[0]):e[0]},o,t)},n.some=l,n.isPromise=a,n.isPromiseLike=a,(w=t.prototype).then=function(e,n,o){var r=this;return new t(function(t,i,s){r._when(t,s,e,n,o)},this._status&&this._status.observed())},w.catch=w.otherwise=function(e){return this.then(N,e)},w.finally=w.ensure=function(e){function n(){return r(e())}return"function"==typeof e?this.then(n,n).yield(this):this},w.done=function(e,n){this.then(e,n).catch(E)},w.yield=function(e){return this.then(function(){return e})},w.tap=function(e){return this.then(e).yield(this)},w.spread=function(e){return this.then(function(n){return f(n,function(n){return e.apply(N,n)})})},w.always=function(e,n){return this.then(e,e,n)},y=Object.create||function(e){function n(){}return n.prototype=e,new n},s.prototype=y(w),s.prototype.inspect=function(){return _(this.value)},s.prototype._when=function(e,n,o){try{e("function"==typeof o?o(this.value):this.value)}catch(n){e(new c(n))}},c.prototype=y(w),c.prototype.inspect=function(){return h(this.value)},c.prototype._when=function(e,n,o,t){try{e("function"==typeof t?t(this.value):this)}catch(n){e(new c(n))}},u.prototype=y(w),u.prototype._when=function(e,n,o,t,r){try{n("function"==typeof r?r(this.value):this.value)}catch(e){n(e)}},x=[],A="undefined"!=typeof console?console:n,"object"==typeof process&&process.nextTick)O=process.nextTick;else if(w="function"==typeof MutationObserver&&MutationObserver||"function"==typeof WebKitMutationObserver&&WebKitMutationObserver)k=document,I=w,M=g,T=k.createElement("div"),new I(M).observe(T,{attributes:!0}),O=function(){T.setAttribute("x","x")};else try{O=e("vertx").runOnLoop||e("vertx").runOnContext}catch(e){m=setTimeout,O=function(e){m(e,0)}}return w=(e=Function.prototype).call,C=e.bind?w.bind(w):function(e,n){return e.apply(n,v.call(arguments,2))},v=(e=[]).slice,S=e.reduce||function(e){var n,o,t,r,i;if(i=0,r=(n=Object(this)).length>>>0,1>=(o=arguments).length)for(;;){if(i in n){t=n[i++];break}if(++i>=r)throw new TypeError}else t=o[1];for(;i<r;++i)i in n&&(t=e(t,n[i],i,n));return t},n});var CryptoJS=CryptoJS||function(e,n){var o={},t=o.lib={},r=t.Base=function(){function e(){}return{extend:function(n){e.prototype=this;var o=new e;return n&&o.mixIn(n),o.hasOwnProperty("init")||(o.init=function(){o.$super.init.apply(this,arguments)}),o.init.prototype=o,o.$super=this,o},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),i=t.WordArray=r.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=null!=n?n:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var n=this.words,o=e.words,t=this.sigBytes;if(e=e.sigBytes,this.clamp(),t%4)for(var r=0;r<e;r++)n[t+r>>>2]|=(o[r>>>2]>>>24-r%4*8&255)<<24-(t+r)%4*8;else if(65535<o.length)for(r=0;r<e;r+=4)n[t+r>>>2]=o[r>>>2];else n.push.apply(n,o);return this.sigBytes+=e,this},clamp:function(){var n=this.words,o=this.sigBytes;n[o>>>2]&=4294967295<<32-o%4*8,n.length=e.ceil(o/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(n){for(var o=[],t=0;t<n;t+=4)o.push(4294967296*e.random()|0);return new i.init(o,n)}}),s=o.enc={},c=s.Hex={stringify:function(e){var n=e.words;e=e.sigBytes;for(var o=[],t=0;t<e;t++){var r=n[t>>>2]>>>24-t%4*8&255;o.push((r>>>4).toString(16)),o.push((15&r).toString(16))}return o.join("")},parse:function(e){for(var n=e.length,o=[],t=0;t<n;t+=2)o[t>>>3]|=parseInt(e.substr(t,2),16)<<24-t%8*4;return new i.init(o,n/2)}},u=s.Latin1={stringify:function(e){var n=e.words;e=e.sigBytes;for(var o=[],t=0;t<e;t++)o.push(String.fromCharCode(n[t>>>2]>>>24-t%4*8&255));return o.join("")},parse:function(e){for(var n=e.length,o=[],t=0;t<n;t++)o[t>>>2]|=(255&e.charCodeAt(t))<<24-t%4*8;return new i.init(o,n)}},a=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},l=t.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new i.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=a.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(n){var o=this._data,t=o.words,r=o.sigBytes,s=this.blockSize,c=r/(4*s);if(n=(c=n?e.ceil(c):e.max((0|c)-this._minBufferSize,0))*s,r=e.min(4*n,r),n){for(var u=0;u<n;u+=s)this._doProcessBlock(t,u);u=t.splice(0,n),o.sigBytes-=r}return new i.init(u,r)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});t.Hasher=l.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(n,o){return new e.init(o).finalize(n)}},_createHmacHelper:function(e){return function(n,o){return new f.HMAC.init(e,o).finalize(n)}}});var f=o.algo={};return o}(Math);!function(){var e=CryptoJS,n=e.lib.WordArray;e.enc.Base64={stringify:function(e){var n=e.words,o=e.sigBytes,t=this._map;e.clamp(),e=[];for(var r=0;r<o;r+=3)for(var i=(n[r>>>2]>>>24-r%4*8&255)<<16|(n[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|n[r+2>>>2]>>>24-(r+2)%4*8&255,s=0;4>s&&r+.75*s<o;s++)e.push(t.charAt(i>>>6*(3-s)&63));if(n=t.charAt(64))for(;e.length%4;)e.push(n);return e.join("")},parse:function(e){var o=e.length,t=this._map;(r=t.charAt(64))&&(-1!=(r=e.indexOf(r))&&(o=r));for(var r=[],i=0,s=0;s<o;s++)if(s%4){var c=t.indexOf(e.charAt(s-1))<<s%4*2,u=t.indexOf(e.charAt(s))>>>6-s%4*2;r[i>>>2]|=(c|u)<<24-i%4*8,i++}return n.create(r,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(){var e=CryptoJS,n=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,o){e=this._hasher=new e.init,"string"==typeof o&&(o=n.parse(o));var t=e.blockSize,r=4*t;o.sigBytes>r&&(o=e.finalize(o)),o.clamp();for(var i=this._oKey=o.clone(),s=this._iKey=o.clone(),c=i.words,u=s.words,a=0;a<t;a++)c[a]^=1549556828,u[a]^=909522486;i.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var n=this._hasher;return e=n.finalize(e),n.reset(),n.finalize(this._oKey.clone().concat(e))}})}(),function(e){var n=CryptoJS,o=(r=n.lib).WordArray,t=r.Hasher,r=n.algo,i=[],s=[];!function(){function n(n){for(var o=e.sqrt(n),t=2;t<=o;t++)if(!(n%t))return!1;return!0}function o(e){return 4294967296*(e-(0|e))|0}for(var t=2,r=0;64>r;)n(t)&&(8>r&&(i[r]=o(e.pow(t,.5))),s[r]=o(e.pow(t,1/3)),r++),t++}();var c=[];r=r.SHA256=t.extend({_doReset:function(){this._hash=new o.init(i.slice(0))},_doProcessBlock:function(e,n){for(var o=this._hash.words,t=o[0],r=o[1],i=o[2],u=o[3],a=o[4],l=o[5],f=o[6],p=o[7],_=0;64>_;_++){if(16>_)c[_]=0|e[n+_];else{var h=c[_-15],d=c[_-2];c[_]=((h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3)+c[_-7]+((d<<15|d>>>17)^(d<<13|d>>>19)^d>>>10)+c[_-16]}h=p+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&f)+s[_]+c[_],d=((t<<30|t>>>2)^(t<<19|t>>>13)^(t<<10|t>>>22))+(t&r^t&i^r&i),p=f,f=l,l=a,a=u+h|0,u=i,i=r,r=t,t=h+d|0}o[0]=o[0]+t|0,o[1]=o[1]+r|0,o[2]=o[2]+i|0,o[3]=o[3]+u|0,o[4]=o[4]+a|0,o[5]=o[5]+l|0,o[6]=o[6]+f|0,o[7]=o[7]+p|0},_doFinalize:function(){var n=this._data,o=n.words,t=8*this._nDataBytes,r=8*n.sigBytes;return o[r>>>5]|=128<<24-r%32,o[14+(r+64>>>9<<4)]=e.floor(t/4294967296),o[15+(r+64>>>9<<4)]=t,n.sigBytes=4*o.length,this._process(),this._hash},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=t._createHelper(r),n.HmacSHA256=t._createHmacHelper(r)}(Math),function(){var e,n=CryptoJS,o=(e=n.lib).Base,t=e.WordArray,r=(e=n.algo).HMAC,i=e.PBKDF2=o.extend({cfg:o.extend({keySize:4,hasher:e.SHA1,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,n){var o=this.cfg,i=r.create(o.hasher,e),s=t.create(),c=t.create([1]),u=s.words,a=c.words,l=o.keySize;for(o=o.iterations;u.length<l;){var f=i.update(n).finalize(c);i.reset();for(var p=f.words,_=p.length,h=f,d=1;d<o;d++){h=i.finalize(h),i.reset();for(var g=h.words,b=0;b<_;b++)p[b]^=g[b]}s.concat(f),a[0]++}return s.sigBytes=4*l,s}});n.PBKDF2=function(e,n,o){return i.create(o).compute(e,n)}}();var AUTOBAHNJS_VERSION="0.8.2",global=this;!function(e,n){"function"==typeof define&&define.amd?define(["when"],function(o){return e.ab=n(e,o)}):"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports&&(exports=module.exports=n(e,e.when)):e.ab=n(e,e.when)}(global,function(e,n){var o={_version:AUTOBAHNJS_VERSION};return Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null===this)throw new TypeError;var n=Object(this),o=n.length>>>0;if(0===o)return-1;var t=0;if(0<arguments.length&&((t=Number(arguments[1]))!=t?t=0:0!==t&&1/0!==t&&-1/0!==t&&(t=(0<t||-1)*Math.floor(Math.abs(t)))),t>=o)return-1;for(t=0<=t?t:Math.max(o-Math.abs(t),0);t<o;t++)if(t in n&&n[t]===e)return t;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,n){var o,t;if(null===this)throw new TypeError(" this is null or not defined");var r=Object(this),i=r.length>>>0;if("[object Function]"!=={}.toString.call(e))throw new TypeError(e+" is not a function");for(n&&(o=n),t=0;t<i;){var s;t in r&&(s=r[t],e.call(o,s,t,r)),t++}}),o._sliceUserAgent=function(e,n,o){var t=[],r=navigator.userAgent;for(e=r.indexOf(e),0>(n=r.indexOf(n,e))&&(n=r.length),r=(o=r.slice(e,n).split(o))[1].split("."),n=0;n<r.length;++n)t.push(parseInt(r[n],10));return{name:o[0],version:t}},o.getBrowser=function(){var e=navigator.userAgent;return-1<e.indexOf("Chrome")?o._sliceUserAgent("Chrome"," ","/"):-1<e.indexOf("Safari")?o._sliceUserAgent("Safari"," ","/"):-1<e.indexOf("Firefox")?o._sliceUserAgent("Firefox"," ","/"):-1<e.indexOf("MSIE")?o._sliceUserAgent("MSIE",";"," "):null},o.getServerUrl=function(n,o){return"file:"===e.location.protocol?o||"ws://127.0.0.1/ws":("https:"===e.location.protocol?"wss://":"ws://")+e.location.hostname+(""!==e.location.port?":"+e.location.port:"")+"/"+(n||"ws")},o.browserNotSupportedMessage="Browser does not support WebSockets (RFC6455)",o.deriveKey=function(e,n){return n&&n.salt?CryptoJS.PBKDF2(e,n.salt,{keySize:(n.keylen||32)/4,iterations:n.iterations||1e4,hasher:CryptoJS.algo.SHA256}).toString(CryptoJS.enc.Base64):e},o._idchars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o._idlen=16,o._subprotocol="wamp",o._newid=function(){for(var e="",n=0;n<o._idlen;n+=1)e+=o._idchars.charAt(Math.floor(Math.random()*o._idchars.length));return e},o._newidFast=function(){return Math.random().toString(36)},o.log=function(){if(1<arguments.length){console.group("Log Item");for(var e=0;e<arguments.length;e+=1)console.log(arguments[e]);console.groupEnd()}else console.log(arguments[0])},o._debugrpc=!1,o._debugpubsub=!1,o._debugws=!1,o._debugconnect=!1,o.debug=function(n,t,r){if(!("console"in e))throw"browser does not support console object";o._debugrpc=n,o._debugpubsub=n,o._debugws=t,o._debugconnect=r},o.version=function(){return o._version},o.PrefixMap=function(){this._index={},this._rindex={}},o.PrefixMap.prototype.get=function(e){return this._index[e]},o.PrefixMap.prototype.set=function(e,n){this._index[e]=n,this._rindex[n]=e},o.PrefixMap.prototype.setDefault=function(e){this._index[""]=e,this._rindex[e]=""},o.PrefixMap.prototype.remove=function(e){var n=this._index[e];n&&(delete this._index[e],delete this._rindex[n])},o.PrefixMap.prototype.resolve=function(e,n){var o=e.indexOf(":");if(0<=o){var t=e.substring(0,o);if(this._index[t])return this._index[t]+e.substring(o+1)}return!0===n?e:null},o.PrefixMap.prototype.shrink=function(e,n){for(var o=e.length;0<o;o-=1){var t=e.substring(0,o);if(t=this._rindex[t])return t+":"+e.substring(o)}return!0===n?e:null},o._MESSAGE_TYPEID_WELCOME=0,o._MESSAGE_TYPEID_PREFIX=1,o._MESSAGE_TYPEID_CALL=2,o._MESSAGE_TYPEID_CALL_RESULT=3,o._MESSAGE_TYPEID_CALL_ERROR=4,o._MESSAGE_TYPEID_SUBSCRIBE=5,o._MESSAGE_TYPEID_UNSUBSCRIBE=6,o._MESSAGE_TYPEID_PUBLISH=7,o._MESSAGE_TYPEID_EVENT=8,o.CONNECTION_CLOSED=0,o.CONNECTION_LOST=1,o.CONNECTION_RETRIES_EXCEEDED=2,o.CONNECTION_UNREACHABLE=3,o.CONNECTION_UNSUPPORTED=4,o.CONNECTION_UNREACHABLE_SCHEDULED_RECONNECT=5,o.CONNECTION_LOST_SCHEDULED_RECONNECT=6,o.Deferred=n.defer,o._construct=function(n,o){return"WebSocket"in e?o?new WebSocket(n,o):new WebSocket(n):"MozWebSocket"in e?o?new MozWebSocket(n,o):new MozWebSocket(n):null},o.Session=function(e,n,t,r){var i=this;if(i._wsuri=e,i._options=r,i._websocket_onopen=n,i._websocket_onclose=t,i._websocket=null,i._websocket_connected=!1,i._session_id=null,i._wamp_version=null,i._server=null,i._calls={},i._subscriptions={},i._prefixes=new o.PrefixMap,i._txcnt=0,i._rxcnt=0,i._websocket=i._options&&i._options.skipSubprotocolAnnounce?o._construct(i._wsuri):o._construct(i._wsuri,[o._subprotocol]),!i._websocket){if(void 0!==t)return void t(o.CONNECTION_UNSUPPORTED);throw o.browserNotSupportedMessage}i._websocket.onmessage=function(e){if(o._debugws&&(i._rxcnt+=1,console.group("WS Receive"),console.info(i._wsuri+"  ["+i._session_id+"]"),console.log(i._rxcnt),console.log(e.data),console.groupEnd()),(e=JSON.parse(e.data))[1]in i._calls){if(e[0]===o._MESSAGE_TYPEID_CALL_RESULT){var n=i._calls[e[1]],t=e[2];if(o._debugrpc&&void 0!==n._ab_callobj){console.group("WAMP Call",n._ab_callobj[2]),console.timeEnd(n._ab_tid),console.group("Arguments");for(var r=3;r<n._ab_callobj.length;r+=1){var s=n._ab_callobj[r];if(void 0===s)break;console.log(s)}console.groupEnd(),console.group("Result"),console.log(t),console.groupEnd(),console.groupEnd()}n.resolve(t)}else if(e[0]===o._MESSAGE_TYPEID_CALL_ERROR){if(n=i._calls[e[1]],t=e[2],r=e[3],s=e[4],o._debugrpc&&void 0!==n._ab_callobj){console.group("WAMP Call",n._ab_callobj[2]),console.timeEnd(n._ab_tid),console.group("Arguments");for(var c=3;c<n._ab_callobj.length;c+=1){var u=n._ab_callobj[c];if(void 0===u)break;console.log(u)}console.groupEnd(),console.group("Error"),console.log(t),console.log(r),void 0!==s&&console.log(s),console.groupEnd(),console.groupEnd()}void 0!==s?n.reject({uri:t,desc:r,detail:s}):n.reject({uri:t,desc:r})}delete i._calls[e[1]]}else if(e[0]===o._MESSAGE_TYPEID_EVENT){if((n=i._prefixes.resolve(e[1],!0))in i._subscriptions){var a=e[1],l=e[2];o._debugpubsub&&(console.group("WAMP Event"),console.info(i._wsuri+"  ["+i._session_id+"]"),console.log(a),console.log(l),console.groupEnd()),i._subscriptions[n].forEach(function(e){e(a,l)})}}else if(e[0]===o._MESSAGE_TYPEID_WELCOME){if(null!==i._session_id)throw"protocol error (welcome message received more than once)";i._session_id=e[1],i._wamp_version=e[2],i._server=e[3],(o._debugrpc||o._debugpubsub)&&(console.group("WAMP Welcome"),console.info(i._wsuri+"  ["+i._session_id+"]"),console.log(i._wamp_version),console.log(i._server),console.groupEnd()),null!==i._websocket_onopen&&i._websocket_onopen()}},i._websocket.onopen=function(e){if(i._websocket.protocol!==o._subprotocol)if(void 0===i._websocket.protocol)o._debugws&&(console.group("WS Warning"),console.info(i._wsuri),console.log("WebSocket object has no protocol attribute: WAMP subprotocol check skipped!"),console.groupEnd());else{if(!i._options||!i._options.skipSubprotocolCheck)throw i._websocket.close(1e3,"server does not speak WAMP"),"server does not speak WAMP (but '"+i._websocket.protocol+"' !)";o._debugws&&(console.group("WS Warning"),console.info(i._wsuri),console.log("Server does not speak WAMP, but subprotocol check disabled by option!"),console.log(i._websocket.protocol),console.groupEnd())}o._debugws&&(console.group("WAMP Connect"),console.info(i._wsuri),console.log(i._websocket.protocol),console.groupEnd()),i._websocket_connected=!0},i._websocket.onerror=function(e){},i._websocket.onclose=function(e){o._debugws&&(i._websocket_connected?console.log("Autobahn connection to "+i._wsuri+" lost (code "+e.code+", reason '"+e.reason+"', wasClean "+e.wasClean+")."):console.log("Autobahn could not connect to "+i._wsuri+" (code "+e.code+", reason '"+e.reason+"', wasClean "+e.wasClean+").")),void 0!==i._websocket_onclose&&(i._websocket_connected?e.wasClean?i._websocket_onclose(o.CONNECTION_CLOSED,"WS-"+e.code+": "+e.reason):i._websocket_onclose(o.CONNECTION_LOST):i._websocket_onclose(o.CONNECTION_UNREACHABLE)),i._websocket_connected=!1,i._wsuri=null,i._websocket_onopen=null,i._websocket_onclose=null,i._websocket=null},i.log=function(){i._options&&"sessionIdent"in i._options?console.group("WAMP Session '"+i._options.sessionIdent+"' ["+i._session_id+"]"):console.group("WAMP Session ["+i._session_id+"]");for(var e=0;e<arguments.length;++e)console.log(arguments[e]);console.groupEnd()}},o.Session.prototype._send=function(n){if(!this._websocket_connected)throw"Autobahn not connected";switch(!0){case e.Prototype&&void 0===top.root.__prototype_deleted:case"function"==typeof n.toJSON:n=n.toJSON();break;default:n=JSON.stringify(n)}this._websocket.send(n),this._txcnt+=1,o._debugws&&(console.group("WS Send"),console.info(this._wsuri+"  ["+this._session_id+"]"),console.log(this._txcnt),console.log(n),console.groupEnd())},o.Session.prototype.close=function(){this._websocket_connected&&this._websocket.close()},o.Session.prototype.sessionid=function(){return this._session_id},o.Session.prototype.wsuri=function(){return this._wsuri},o.Session.prototype.shrink=function(e,n){return void 0===n&&(n=!0),this._prefixes.shrink(e,n)},o.Session.prototype.resolve=function(e,n){return void 0===n&&(n=!0),this._prefixes.resolve(e,n)},o.Session.prototype.prefix=function(e,n){this._prefixes.set(e,n),(o._debugrpc||o._debugpubsub)&&(console.group("WAMP Prefix"),console.info(this._wsuri+"  ["+this._session_id+"]"),console.log(e),console.log(n),console.groupEnd()),this._send([o._MESSAGE_TYPEID_PREFIX,e,n])},o.Session.prototype.call=function(){for(var e,n=new o.Deferred;(e=o._newidFast())in this._calls;);this._calls[e]=n;for(var t=this._prefixes.shrink(arguments[0],!0),r=(t=[o._MESSAGE_TYPEID_CALL,e,t],1);r<arguments.length;r+=1)t.push(arguments[r]);return this._send(t),o._debugrpc&&(n._ab_callobj=t,n._ab_tid=this._wsuri+"  ["+this._session_id+"]["+e+"]",console.time(n._ab_tid),console.info()),n.promise.then?n.promise:n},o.Session.prototype.subscribe=function(e,n){var t=this._prefixes.resolve(e,!0);if(t in this._subscriptions||(o._debugpubsub&&(console.group("WAMP Subscribe"),console.info(this._wsuri+"  ["+this._session_id+"]"),console.log(e),console.log(n),console.groupEnd()),this._send([o._MESSAGE_TYPEID_SUBSCRIBE,e]),this._subscriptions[t]=[]),-1!==this._subscriptions[t].indexOf(n))throw"callback "+n+" already subscribed for topic "+t;this._subscriptions[t].push(n)},o.Session.prototype.unsubscribe=function(e,n){var t,r=this._prefixes.resolve(e,!0);if(!(r in this._subscriptions))throw"not subscribed to topic "+r;if(void 0!==n){var i=this._subscriptions[r].indexOf(n);if(-1===i)throw"no callback "+n+" subscribed on topic "+r;t=n,this._subscriptions[r].splice(i,1)}else t=this._subscriptions[r].slice(),this._subscriptions[r]=[];0===this._subscriptions[r].length&&(delete this._subscriptions[r],o._debugpubsub&&(console.group("WAMP Unsubscribe"),console.info(this._wsuri+"  ["+this._session_id+"]"),console.log(e),console.log(t),console.groupEnd()),this._send([o._MESSAGE_TYPEID_UNSUBSCRIBE,e]))},o.Session.prototype.publish=function(){var e=arguments[0],n=arguments[1],t=null,r=null,i=null,s=null;if(3<arguments.length){if(!(arguments[2]instanceof Array))throw"invalid argument type(s)";if(!(arguments[3]instanceof Array))throw"invalid argument type(s)";r=arguments[2],i=arguments[3],s=[o._MESSAGE_TYPEID_PUBLISH,e,n,r,i]}else if(2<arguments.length)if("boolean"==typeof arguments[2])t=arguments[2],s=[o._MESSAGE_TYPEID_PUBLISH,e,n,t];else{if(!(arguments[2]instanceof Array))throw"invalid argument type(s)";r=arguments[2],s=[o._MESSAGE_TYPEID_PUBLISH,e,n,r]}else s=[o._MESSAGE_TYPEID_PUBLISH,e,n];o._debugpubsub&&(console.group("WAMP Publish"),console.info(this._wsuri+"  ["+this._session_id+"]"),console.log(e),console.log(n),null!==t?console.log(t):null!==r&&(console.log(r),null!==i&&console.log(i)),console.groupEnd()),this._send(s)},o.Session.prototype.authreq=function(e,n){return this.call("http://api.wamp.ws/procedure#authreq",e,n)},o.Session.prototype.authsign=function(e,n){return n||(n=""),CryptoJS.HmacSHA256(e,n).toString(CryptoJS.enc.Base64)},o.Session.prototype.auth=function(e){return this.call("http://api.wamp.ws/procedure#auth",e)},o._connect=function(n){var t=new o.Session(n.wsuri,function(){n.connects+=1,n.retryCount=0,n.onConnect(t)},function(t,r){switch(t){case o.CONNECTION_CLOSED:n.onHangup(t,"Connection was closed properly ["+r+"]");break;case o.CONNECTION_UNSUPPORTED:n.onHangup(t,"Browser does not support WebSocket.");break;case o.CONNECTION_UNREACHABLE:n.retryCount+=1,0===n.connects?n.onHangup(t,"Connection could not be established."):n.retryCount<=n.options.maxRetries?n.onHangup(o.CONNECTION_UNREACHABLE_SCHEDULED_RECONNECT,"Connection unreachable - scheduled reconnect to occur in "+n.options.retryDelay/1e3+" second(s) - attempt "+n.retryCount+" of "+n.options.maxRetries+".",{delay:n.options.retryDelay,retries:n.retryCount,maxretries:n.options.maxRetries})?(o._debugconnect&&console.log("Connection unreachable - retrying stopped by app"),n.onHangup(o.CONNECTION_RETRIES_EXCEEDED,"Number of connection retries exceeded.")):(o._debugconnect&&console.log("Connection unreachable - retrying ("+n.retryCount+") .."),e.setTimeout(function(){o._connect(n)},n.options.retryDelay)):n.onHangup(o.CONNECTION_RETRIES_EXCEEDED,"Number of connection retries exceeded.");break;case o.CONNECTION_LOST:n.retryCount+=1,n.retryCount<=n.options.maxRetries?n.onHangup(o.CONNECTION_LOST_SCHEDULED_RECONNECT,"Connection lost - scheduled "+n.retryCount+"th reconnect to occur in "+n.options.retryDelay/1e3+" second(s).",{delay:n.options.retryDelay,retries:n.retryCount,maxretries:n.options.maxRetries})?(o._debugconnect&&console.log("Connection lost - retrying stopped by app"),n.onHangup(o.CONNECTION_RETRIES_EXCEEDED,"Connection lost.")):(o._debugconnect&&console.log("Connection lost - retrying ("+n.retryCount+") .."),e.setTimeout(function(){o._connect(n)},n.options.retryDelay)):n.onHangup(o.CONNECTION_RETRIES_EXCEEDED,"Connection lost.");break;default:throw"unhandled close code in ab._connect"}},n.options)},o.connect=function(e,n,t,r){var i={};if(i.wsuri=e,i.options=r||{},void 0===i.options.retryDelay&&(i.options.retryDelay=5e3),void 0===i.options.maxRetries&&(i.options.maxRetries=10),void 0===i.options.skipSubprotocolCheck&&(i.options.skipSubprotocolCheck=!1),void 0===i.options.skipSubprotocolAnnounce&&(i.options.skipSubprotocolAnnounce=!1),!n)throw"onConnect handler required!";i.onConnect=n,i.onHangup=t||function(e,n,t){o._debugconnect&&console.log(e,n,t)},i.connects=0,i.retryCount=0,o._connect(i)},o.launch=function(e,n,t){o.connect(e.wsuri,function(t){e.appkey&&""!==e.appkey?t.authreq(e.appkey,e.appextra).then(function(r){var i=null;"function"==typeof e.appsecret?i=e.appsecret(r):(i=o.deriveKey(e.appsecret,JSON.parse(r).authextra),i=t.authsign(r,i)),t.auth(i).then(function(e){n?n(t):o._debugconnect&&t.log("Session opened.")},t.log)},t.log):t.authreq().then(function(){t.auth().then(function(e){n?n(t):o._debugconnect&&t.log("Session opened.")},t.log)},t.log)},function(e,n,r){t?t(e,n,r):o._debugconnect&&o.log("Session closed.",e,n,r)},e.sessionConfig)},o}),ab._UA_FIREFOX=/.*Firefox\/([0-9+]*).*/,ab._UA_CHROME=/.*Chrome\/([0-9+]*).*/,ab._UA_CHROMEFRAME=/.*chromeframe\/([0-9]*).*/,ab._UA_WEBKIT=/.*AppleWebKit\/([0-9+.]*)w*.*/,ab._UA_WEBOS=/.*webOS\/([0-9+.]*)w*.*/,ab._matchRegex=function(e,n){var o=n.exec(e);return o?o[1]:o},ab.lookupWsSupport=function(){var e=navigator.userAgent;if(-1<e.indexOf("MSIE")){if(-1<e.indexOf("MSIE 10"))return[!0,!0,!0];if(-1<e.indexOf("chromeframe")){var n=parseInt(ab._matchRegex(e,ab._UA_CHROMEFRAME));return 14<=n?[!0,!1,!0]:[!1,!1,!1]}if(-1<e.indexOf("MSIE 8")||-1<e.indexOf("MSIE 9"))return[!0,!0,!0]}else{if(-1<e.indexOf("Firefox")){if(n=parseInt(ab._matchRegex(e,ab._UA_FIREFOX))){if(7<=n)return[!0,!1,!0];if(3<=n)return[!0,!0,!0]}return[!1,!1,!0]}if(-1<e.indexOf("Safari")&&-1==e.indexOf("Chrome")){if(n=ab._matchRegex(e,ab._UA_WEBKIT))return-1<e.indexOf("Windows")&&"534+"==n||-1<e.indexOf("Macintosh")&&(n=n.replace("+","").split("."),535==parseInt(n[0])&&24<=parseInt(n[1])||535<parseInt(n[0]))?[!0,!1,!0]:-1<e.indexOf("webOS")?(n=ab._matchRegex(e,ab._UA_WEBOS).split("."),2==parseInt(n[0])?[!1,!0,!0]:[!1,!1,!1]):[!0,!0,!0]}else if(-1<e.indexOf("Chrome")){if(n=parseInt(ab._matchRegex(e,ab._UA_CHROME)))return 14<=n?[!0,!1,!0]:4<=n?[!0,!0,!0]:[!1,!1,!0]}else if(-1<e.indexOf("Android")){if(-1<e.indexOf("Firefox")||-1<e.indexOf("CrMo"))return[!0,!1,!0];if(-1<e.indexOf("Opera"))return[!1,!1,!0];if(-1<e.indexOf("CrMo"))return[!0,!0,!0]}else if(-1<e.indexOf("iPhone")||-1<e.indexOf("iPad")||-1<e.indexOf("iPod"))return[!1,!1,!0]}return[!1,!1,!1]};